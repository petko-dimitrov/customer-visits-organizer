{% extends 'base.html.twig' %}

{% block main %}
    <h1>All Customers</h1>
    <button type="button" class="btn btn-warning"><a href="{{ path('create_customer') }}">Create Customer</a></button>
    <table class="table table-hover table-striped table-bordered">
        <thead class="thead-dark">
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Phone Number</th>
            <th scope="col">Email</th>
            <th scope="col">Website</th>
            <th scope="col">Monthly Tax</th>
            <th scope="col">Visits</th>
            <th scope="col">Actions</th>
        </tr>
        </thead>
        <tbody>
        {% for customer in customers %}
        <tr>
            <td>{{ customer.name }}</td>
            <td><a href="tel:{{ customer.phone }}">{{ customer.phone }}</a></td>
            <td><a href="mailto:{{ customer.email }}">{{ customer.email }}</a></td>
            <td><a href="{{ customer.website }}" target="_blank">{{ customer.website }}</a></td>
            <td>${{ customer.monthlyTax }}</td>
            <td>
                <a href="{{ path('planned_customer_visits', {id: customer.id}) }}"><button type="button" class="btn btn-small btn-info">Planned</button></a>
                <a href="{{ path('all_customer_visits', {id: customer.id}) }}"><button type="button" class="btn btn-small btn-primary">Past</button></a>
                <a href="{{ path('add_visit', {id: customer.id}) }}"><button type="button" class="btn btn-small btn-success">Add</button></a>
                {% for visit in customer.visits|sortbyfield('date') %}
                    {% if visit.isFinished == false %}
                        <p>{{ visit.date|date("d-M-Y") }}</p>
                    {% endif %}
                {% endfor %}
            </td>
            <td>
                <a href="{{ path('view_one', {id: customer.id}) }}"><button type="button" class="btn btn-small btn-primary">More Info</button></a>
                <a href="{{ path('edit_customer', {id: customer.id}) }}"><button type="button" class="btn btn-small btn-success">Edit</button></a>
                <a href="{{ path('delete_customer', {id: customer.id}) }}"><button type="button" class="btn btn-small btn-danger">Delete</button></a>
            </td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
{% endblock %}

